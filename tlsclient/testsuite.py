# -*- coding: utf-8 -*-
"""Module containing the test suite
"""
import pickle
import tlsclient.tls_message as msg
import tlsclient.constants as tls
from tlsclient.recorder import RecorderState

class TestSuite(object):
    def __init__(self, logger, server_profile, client_profile_factory):
        self.logger = logger
        self.server_profile = server_profile
        self.create_client_profile = client_profile_factory

    def run(self):
        print("Ok, we run")

        client_profile = self.create_client_profile()
        client_profile.tls_versions = [tls.Version.TLS12]
        client_profile.cipher_suites = [
            # tls.CipherSuite.TLS_AES_128_GCM_SHA256,
            # tls.CipherSuite.TLS_CHACHA20_POLY1305_SHA256,
            # tls.CipherSuite.TLS_AES_256_GCM_SHA384,
            # tls.CipherSuite.TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,
            # tls.CipherSuite.TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,
            # tls.CipherSuite.TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256,
            # tls.CipherSuite.TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256,
            # tls.CipherSuite.TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,
            # tls.CipherSuite.TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,
            tls.CipherSuite.TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA,
            tls.CipherSuite.TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256,
            tls.CipherSuite.TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA,
            tls.CipherSuite.TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA,
            tls.CipherSuite.TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA,
            # tls.CipherSuite.TLS_RSA_WITH_AES_128_GCM_SHA256,
            # tls.CipherSuite.TLS_RSA_WITH_AES_256_GCM_SHA384,
            tls.CipherSuite.TLS_RSA_WITH_AES_128_CBC_SHA,
            tls.CipherSuite.TLS_RSA_WITH_AES_256_CBC_SHA,
            tls.CipherSuite.TLS_RSA_WITH_3DES_EDE_CBC_SHA,
            tls.CipherSuite.TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256,
        ]
        client_profile.supported_groups = [
            tls.SupportedGroups.X25519,
            tls.SupportedGroups.SECP256R1,
            tls.SupportedGroups.SECP384R1,
            tls.SupportedGroups.SECP521R1,
            tls.SupportedGroups.FFDHE2048,
            tls.SupportedGroups.FFDHE4096,
        ]
        client_profile.signature_algorithms = [
            tls.SignatureScheme.ECDSA_SECP256R1_SHA256,
            tls.SignatureScheme.ECDSA_SECP384R1_SHA384,
            tls.SignatureScheme.ECDSA_SECP521R1_SHA512,
            tls.SignatureScheme.RSA_PSS_RSAE_SHA256,
            tls.SignatureScheme.RSA_PSS_RSAE_SHA384,
            tls.SignatureScheme.RSA_PSS_RSAE_SHA512,
            tls.SignatureScheme.RSA_PKCS1_SHA256,
            tls.SignatureScheme.RSA_PKCS1_SHA384,
            tls.SignatureScheme.RSA_PKCS1_SHA512,
            tls.SignatureScheme.ECDSA_SHA1,
            tls.SignatureScheme.RSA_PKCS1_SHA1,
        ]

        with client_profile.create_connection() as conn:

            #recorder = pickle.loads(b'\x80\x03ctlsclient.recorder\nRecorder\nq\x00)\x81q\x01}q\x02(X\x05\x00\x00\x00stateq\x03ctlsclient.recorder\nRecorderState\nq\x04K\x01\x85q\x05Rq\x06X\t\x00\x00\x00_msg_flowq\x07]q\x08(}q\t(X\t\x00\x00\x00directionq\nK\x01X\x03\x00\x00\x00msgq\x0bctlsclient.protocol\nProtocolData\nq\x0cC\x84\x16\x03\x01\x00\x7f\x01\x00\x00{\x03\x03_e\x02\x8e\x94\x80%\xbb\xb6\xd0V\xc4\xc5O\xd9\xb9\xa6\x1bXA\xad<B\x84\xccV\x1d\xa2\xcfV\x80\x83\x00\x00\x12\xc0\n\xc0#\xc0\t\xc0\x13\xc0\x14\x00/\x005\x00\n\xc0\'\x01\x00\x00@\x00\x00\x00\x0e\x00\x0c\x00\x00\tlocalhost\x00\n\x00\x0e\x00\x0c\x00\x1d\x00\x17\x00\x18\x00\x19\x01\x00\x01\x02\x00\r\x00\x18\x00\x16\x04\x03\x05\x03\x06\x03\x08\x04\x08\x05\x08\x06\x04\x01\x05\x01\x06\x01\x02\x03\x02\x01q\r\x85q\x0eRq\x0f}q\x10bu}q\x11(h\nK\x00h\x0bB\x8f\x05\x00\x00\x16\x03\x03\x00J\x02\x00\x00F\x03\x03\x93\x9e\x1dl2|\xb2\xe8.\xd4\xf4k\xed\xe8R\xcd%\x05:Oc\xa6\xf3\xad\r\xb2\xbd\xdeT\xf8\x80= u\no\x81a\xd8\xc2g3\xb5\xb4\xb4y\x98\x9cT\x98\x8d\xbe<Z\x0c{\xcfo\xd9\xf0\x98\x9d<\xd0\xed\xc0\'\x00\x16\x03\x03\x04\x01\x0b\x00\x03\xfd\x00\x03\xfa\x00\x03\xf70\x82\x03\xf30\x82\x02\xdb\xa0\x03\x02\x01\x02\x02\x14fC\x9d\x04>U\x0f\x7f\xde\xac_\xef\x8bj\x84\x1cX:\xca\x120\r\x06\t*\x86H\x86\xf7\r\x01\x01\x0b\x05\x000\x81\x881\x0b0\t\x06\x03U\x04\x06\x13\x02DE1\x100\x0e\x06\x03U\x04\x08\x0c\x07Germany1\r0\x0b\x06\x03U\x04\x07\x0c\x04Tamm1\x130\x11\x06\x03U\x04\n\x0c\nguballa.de1\x0f0\r\x06\x03U\x04\x0b\x0c\x06Privat1\x120\x10\x06\x03U\x04\x03\x0c\tlocalhost1\x1e0\x1c\x06\t*\x86H\x86\xf7\r\x01\t\x01\x16\x0fjens@guballa.de0\x1e\x17\r200905133359Z\x17\r210905133359Z0\x81\x881\x0b0\t\x06\x03U\x04\x06\x13\x02DE1\x100\x0e\x06\x03U\x04\x08\x0c\x07Germany1\r0\x0b\x06\x03U\x04\x07\x0c\x04Tamm1\x130\x11\x06\x03U\x04\n\x0c\nguballa.de1\x0f0\r\x06\x03U\x04\x0b\x0c\x06Privat1\x120\x10\x06\x03U\x04\x03\x0c\tlocalhost1\x1e0\x1c\x06\t*\x86H\x86\xf7\r\x01\t\x01\x16\x0fjens@guballa.de0\x82\x01"0\r\x06\t*\x86H\x86\xf7\r\x01\x01\x01\x05\x00\x03\x82\x01\x0f\x000\x82\x01\n\x02\x82\x01\x01\x00\xb2\xc8oZ\xe5\x1b\xbeM\xc4\x82,f\xbfU\xfa<R~\x93\xc7\xc6\xcb\xa6\xcf{&_\xb4\xb0S\x80\xb3x\xea6r}\x80\x8b\xad\xc5\xbe\x98\x1a\xd6\xd6\xdc\xa00\x91\x0c\xe2h\x80D\x94\\\x01<\xaa\xebmg\\cZ\x1b:H\xea\xec9\xc3Y\x9c\xca`\x196i\xbb\xbe\x1f\xae\xc3\xb9x\xc9\x82\xa1\xba\x17\x08\x17\xb6\xe1\x16\xae\xabq\xe9\xbaj\x84\xcd\xc4\xc7A\xb3.\t\xd7\xe1\xa8\x1b\xe3\x7fO\x03\xac\xddKy\x81*\xce\xa8r5\xc5L\xf5\x06x\x18GF#H5\xff\x0b\xf2\\`\xe3\x1a\xde\n\t\x02\xcf\\\x0b\xe3%\x14!o\xd2\x92*\x11\x8eO\xaaY\xb4bu\x8e`u\xc8\xa1%*\x93\x83\xf7C\xcf\xc6\xb8\xb33\xa5<\xf7\x9aQ-\xb9\xdf\xdc\x14\x17\x15G?\x8dC\x13\xfc\x8132\x92*\x08=\xae"\x06\xfe\x01\xea\t\xbb\x93,\x04"\xa3\xe3\xc4\nu\xe9\x17\xb1\x98j\x9e\x02\xf06\xaf\x07^\x00&\x10\xc6>\x95\xbe\xfb-/|\xdd\xd2\xb4~G\x02\x03\x01\x00\x01\xa3S0Q0\x1d\x06\x03U\x1d\x0e\x04\x16\x04\x14 \xfe,\xe5U9\xf7\x86(\'\x80%eg\x16=|\xa5`\x8a0\x1f\x06\x03U\x1d#\x04\x180\x16\x80\x14 \xfe,\xe5U9\xf7\x86(\'\x80%eg\x16=|\xa5`\x8a0\x0f\x06\x03U\x1d\x13\x01\x01\xff\x04\x050\x03\x01\x01\xff0\r\x06\t*\x86H\x86\xf7\r\x01\x01\x0b\x05\x00\x03\x82\x01\x01\x00\x96}\xb2\xfdY\xb4t\x1b#\x00 \x0eJ\xf7*\xe0q|\xe1\xd2\x04Aj-\xf0G\x91\xb0\xf3G\xb0\xedB\xc9\xbe\xeb c\xed\x99[\x10\x1e\xad\xafw\x03@S\x93\xd7\xed\xa1\x91*\xa6\xa6\x0e\xd6\x02\xc4\xf6G\xf8{\r\xbeT\x91\x91\xf9@\xeb\xa9H\x1f\xb7l$K\x05\\\xd5\x16h\xdem\x92\n^zkf\xa1\xed\xcc\x9a6D\xcf9\xd1\xbf\xc5C\xc1h\\\xe4\xe1\x1f\xf04Nm\xc2g\x0e\x90\x9b\xb4\x11\xa7Sr\xdc\xbe \xaf\x92\x05\xf9\xc6\xe7{\xad\x80\xe3\xa2\xb0\xa1vR\xc3\x91\xb2|<\xd3\x12Z\xa3\xa8`#K\x86?\xb3`\xa2-\x93\xfdR\x13\x00\xed\xb1B\x0c\xe7\x1de\x103K=0T\xa4\x98V\xe4\xd2\x0f>o:\xcaN\xcd\xfc\x11bU\xa1F%\x17\xa2) \xd2\x8cq\x80\xc1\xa4\x9c\x9e\xf0\x9fz\x1b\xa2\xd85\xb3\xf3\xa2\xf1\xd5\xe7{\x00\x15\x90A\x17\xaa\tP\x91u\x0eB\\u\xee\xcb\x86;7s0\xb0\x1e\x98\xfa"\x9c\xfe\xc9Oe\x16\x03\x03\x01,\x0c\x00\x01(\x03\x00\x1d 0\xb9oo\xe3R\x90\xdc\xf8\x88o\xe8[V8\xf8\xe2\x1a\xd3\xdd2J\xa0\x0b\x00\x888\x84Q\x0f\xd0w\x08\x04\x01\x00\x0b\x8b\xdb\xb2;\x04\xb1\xe0t\xd5i\xcf~\xbb.\x8e\x91*s<$\x19"\x05\x8c7\xdc\n\xb1_\xcd\x10\xa9x\xd2\xfb\xe0\xa7\x17\x03%z\x05\x02c\'\x0f\xdf~Lxy\xef\xdad\x1a\xd6\xbe\x1d\xfee\x9d\x12b7+\x06/\x0fh\x1cM\x93jU\x1ah\x11&\xd9\xeeb\xa7[.E?\xc0\x9bl\xe3\x91\x81\xec\xe4\t\x9f7\x880dJF\xce(m!\x9f\x8b\x98H\xfc\xb5Q\xcc\xc8\xcd\x18>\x89\xbd|q/\xaeHP\xa7\x93*\x8d\x97\xed\xda\xd6\xa5Z\xc1_\x08\xab\x82\rH\xab\x9b\x1c"\xbd\xe3\xaf\x98\x86\xd5\xa6-\xfe\xed\xe3S<\xe9\x96\xb9<[\xae\x02V:Y\x95\x0f\x81\x81\x967cPr\xd9\xec\xa5\xb4\xc7|\xb0\x19\xd9\x8c\rG\x1f\xae\xe6\x0e\xecH\xf1g\xacv\x99\xc1G\x0c\x96Z\x86\xca\x98*\xf9\xf3\x85\xf8\xf9\xa5I\x1a\xe6_\xb1\x90=5?\xe3\x9ez\x82\xa1\x1dHF\xd7\xbaF\x86\x81\xc4\xbc?\xa9\xe2[(,\x8a\x9a/\t\xc2\xd9\x8f+\x16\x03\x03\x00\x04\x0e\x00\x00\x00q\x12u}q\x13(h\nK\x01h\x0bh\x0cC\x85\x16\x03\x03\x00%\x10\x00\x00! \x90\x98\xb8U\x1dr\x8b\x9f\xcc\xb5\xf0\x11\x88\xf5R\x89\x14.\x05\'?_\x0c\xff\x8b\x95\x02f\xe1\x953 \x14\x03\x03\x00\x01\x01\x16\x03\x03\x00PZ\x16!\xf9\x1c\xc7\xa3\xbft]\xda\'\xcc=\xa8\xb54\xea\xce_\xb0\x82H\xc3\xae\xf90t\xb1b\xe3H\xd8N\x1c\x84\xff\x14\xa5\xednW\xadTXdc/o\xdab\xca3\x00\xfcn|[Y\xdb\xd5\x02\xa0\x85\xe0?=\x92J\x8e\xcf!M\xa5\x9f<\xe9\xa3\xec#q\x14\x85q\x15Rq\x16}q\x17bu}q\x18(h\nK\x00h\x0bC[\x14\x03\x03\x00\x01\x01\x16\x03\x03\x00P\xc7v\xeb\xca\xa4\x00_[\x93G\x9d\x06\xe3\xd7P\xe2yc&aH\xfb@@\x96\'IV\x0cx\xe0\xed4\xc9\xb0H\xf3UQ\xb4d\x1d\xf4P\xe8\xb2e\x8e\x03\xec\xf2\xd93H\x01\xe06N\'\x05G?jp\xafpH\xf0\xc3\xf3V\xd1\xd4@\x97f\xa2\x82\xbb\xb2q\x19u}q\x1a(h\nK\x01h\x0bh\x0cCU\x17\x03\x03\x00P\x18[i\xae\x8a\xd4\xc0\xf0\xf3:k\xb4+\x0e\x04"\x0b=\x84P\xae\x8e\xa8\x8c6\xe9;\xb7\xfd\x92\x9b\x83\xb3\xaa7p\xf7u\x91<\xa7\xce\xd2\x05\xa1\x846\x81\xc2\x11^B\n\x07\xb6\xa7w\x05\xb1|\xe9\xf7l5\xc1\x96\x0bE\x85\xc7\xa1\x94\xc6\xca\x9e\x9e\xf8\xc0\xbc\x15q\x1b\x85q\x1cRq\x1d}q\x1ebueX\r\x00\x00\x00client_randomq\x1fh\x0cC _e\x02\x8e\x94\x80%\xbb\xb6\xd0V\xc4\xc5O\xd9\xb9\xa6\x1bXA\xad<B\x84\xccV\x1d\xa2\xcfV\x80\x83q \x85q!Rq"}q#bX\r\x00\x00\x00server_randomq$NX\x11\x00\x00\x00pre_master_secretq%NX\r\x00\x00\x00master_secretq&Nub.')
            #recorder =  pickle.loads(b'\x80\x03ctlsclient.recorder\nRecorder\nq\x00)\x81q\x01}q\x02(X\x05\x00\x00\x00stateq\x03ctlsclient.recorder\nRecorderState\nq\x04K\x01\x85q\x05Rq\x06X\t\x00\x00\x00_msg_flowq\x07]q\x08(}q\t(X\t\x00\x00\x00directionq\nK\x01X\x03\x00\x00\x00msgq\x0bctlsclient.protocol\nProtocolData\nq\x0cC\x84\x16\x03\x01\x00\x7f\x01\x00\x00{\x03\x03_e\x12\xc5\x92\xbf2\xda\x01\xbf\x94 \xbf\x84\xba\xddR\x84,7CT\xb5\xc60\xd1\xaa\xe3\x9f\xc0Wq\x00\x00\x12\xc0\n\xc0#\xc0\t\xc0\x13\xc0\x14\x00/\x005\x00\n\xc0\'\x01\x00\x00@\x00\x00\x00\x0e\x00\x0c\x00\x00\tlocalhost\x00\n\x00\x0e\x00\x0c\x00\x1d\x00\x17\x00\x18\x00\x19\x01\x00\x01\x02\x00\r\x00\x18\x00\x16\x04\x03\x05\x03\x06\x03\x08\x04\x08\x05\x08\x06\x04\x01\x05\x01\x06\x01\x02\x03\x02\x01q\r\x85q\x0eRq\x0f}q\x10bu}q\x11(h\nK\x00h\x0bB\x8f\x05\x00\x00\x16\x03\x03\x00J\x02\x00\x00F\x03\x03[t\xddc\x8c{3\xd8\xc12%e&[\x94\xc8\xb8ohu\x184\x82\xbe\xe6\x8b}\x94\xb0\xa0}\x80 \xe9\xed\xa12\t\xdc\x13\x901tJls\xd5\xfe\xb5\xca\xc6\xc1\'k\xd97\xc4\x9e\xd1\xeey~\xfb\xabD\xc0\'\x00\x16\x03\x03\x04\x01\x0b\x00\x03\xfd\x00\x03\xfa\x00\x03\xf70\x82\x03\xf30\x82\x02\xdb\xa0\x03\x02\x01\x02\x02\x14fC\x9d\x04>U\x0f\x7f\xde\xac_\xef\x8bj\x84\x1cX:\xca\x120\r\x06\t*\x86H\x86\xf7\r\x01\x01\x0b\x05\x000\x81\x881\x0b0\t\x06\x03U\x04\x06\x13\x02DE1\x100\x0e\x06\x03U\x04\x08\x0c\x07Germany1\r0\x0b\x06\x03U\x04\x07\x0c\x04Tamm1\x130\x11\x06\x03U\x04\n\x0c\nguballa.de1\x0f0\r\x06\x03U\x04\x0b\x0c\x06Privat1\x120\x10\x06\x03U\x04\x03\x0c\tlocalhost1\x1e0\x1c\x06\t*\x86H\x86\xf7\r\x01\t\x01\x16\x0fjens@guballa.de0\x1e\x17\r200905133359Z\x17\r210905133359Z0\x81\x881\x0b0\t\x06\x03U\x04\x06\x13\x02DE1\x100\x0e\x06\x03U\x04\x08\x0c\x07Germany1\r0\x0b\x06\x03U\x04\x07\x0c\x04Tamm1\x130\x11\x06\x03U\x04\n\x0c\nguballa.de1\x0f0\r\x06\x03U\x04\x0b\x0c\x06Privat1\x120\x10\x06\x03U\x04\x03\x0c\tlocalhost1\x1e0\x1c\x06\t*\x86H\x86\xf7\r\x01\t\x01\x16\x0fjens@guballa.de0\x82\x01"0\r\x06\t*\x86H\x86\xf7\r\x01\x01\x01\x05\x00\x03\x82\x01\x0f\x000\x82\x01\n\x02\x82\x01\x01\x00\xb2\xc8oZ\xe5\x1b\xbeM\xc4\x82,f\xbfU\xfa<R~\x93\xc7\xc6\xcb\xa6\xcf{&_\xb4\xb0S\x80\xb3x\xea6r}\x80\x8b\xad\xc5\xbe\x98\x1a\xd6\xd6\xdc\xa00\x91\x0c\xe2h\x80D\x94\\\x01<\xaa\xebmg\\cZ\x1b:H\xea\xec9\xc3Y\x9c\xca`\x196i\xbb\xbe\x1f\xae\xc3\xb9x\xc9\x82\xa1\xba\x17\x08\x17\xb6\xe1\x16\xae\xabq\xe9\xbaj\x84\xcd\xc4\xc7A\xb3.\t\xd7\xe1\xa8\x1b\xe3\x7fO\x03\xac\xddKy\x81*\xce\xa8r5\xc5L\xf5\x06x\x18GF#H5\xff\x0b\xf2\\`\xe3\x1a\xde\n\t\x02\xcf\\\x0b\xe3%\x14!o\xd2\x92*\x11\x8eO\xaaY\xb4bu\x8e`u\xc8\xa1%*\x93\x83\xf7C\xcf\xc6\xb8\xb33\xa5<\xf7\x9aQ-\xb9\xdf\xdc\x14\x17\x15G?\x8dC\x13\xfc\x8132\x92*\x08=\xae"\x06\xfe\x01\xea\t\xbb\x93,\x04"\xa3\xe3\xc4\nu\xe9\x17\xb1\x98j\x9e\x02\xf06\xaf\x07^\x00&\x10\xc6>\x95\xbe\xfb-/|\xdd\xd2\xb4~G\x02\x03\x01\x00\x01\xa3S0Q0\x1d\x06\x03U\x1d\x0e\x04\x16\x04\x14 \xfe,\xe5U9\xf7\x86(\'\x80%eg\x16=|\xa5`\x8a0\x1f\x06\x03U\x1d#\x04\x180\x16\x80\x14 \xfe,\xe5U9\xf7\x86(\'\x80%eg\x16=|\xa5`\x8a0\x0f\x06\x03U\x1d\x13\x01\x01\xff\x04\x050\x03\x01\x01\xff0\r\x06\t*\x86H\x86\xf7\r\x01\x01\x0b\x05\x00\x03\x82\x01\x01\x00\x96}\xb2\xfdY\xb4t\x1b#\x00 \x0eJ\xf7*\xe0q|\xe1\xd2\x04Aj-\xf0G\x91\xb0\xf3G\xb0\xedB\xc9\xbe\xeb c\xed\x99[\x10\x1e\xad\xafw\x03@S\x93\xd7\xed\xa1\x91*\xa6\xa6\x0e\xd6\x02\xc4\xf6G\xf8{\r\xbeT\x91\x91\xf9@\xeb\xa9H\x1f\xb7l$K\x05\\\xd5\x16h\xdem\x92\n^zkf\xa1\xed\xcc\x9a6D\xcf9\xd1\xbf\xc5C\xc1h\\\xe4\xe1\x1f\xf04Nm\xc2g\x0e\x90\x9b\xb4\x11\xa7Sr\xdc\xbe \xaf\x92\x05\xf9\xc6\xe7{\xad\x80\xe3\xa2\xb0\xa1vR\xc3\x91\xb2|<\xd3\x12Z\xa3\xa8`#K\x86?\xb3`\xa2-\x93\xfdR\x13\x00\xed\xb1B\x0c\xe7\x1de\x103K=0T\xa4\x98V\xe4\xd2\x0f>o:\xcaN\xcd\xfc\x11bU\xa1F%\x17\xa2) \xd2\x8cq\x80\xc1\xa4\x9c\x9e\xf0\x9fz\x1b\xa2\xd85\xb3\xf3\xa2\xf1\xd5\xe7{\x00\x15\x90A\x17\xaa\tP\x91u\x0eB\\u\xee\xcb\x86;7s0\xb0\x1e\x98\xfa"\x9c\xfe\xc9Oe\x16\x03\x03\x01,\x0c\x00\x01(\x03\x00\x1d \xd7L\xb2|\xa8\x13*\xdf\xd9\x96\xaa\xb6q\x86\x1d\xa5p\x95\xca\x0f\x96\xcf\xeb\n\xa8g\xa5~\xc9\xae\xd4\\\x08\x04\x01\x00\xa0\xceW?\rmal\x99\xe6\x8d\x8b\xd8\xcdC5\xe2\x80\x90\xd0B\x89Z\x98J\xf9s\xd9\x7f\xf3u\x1f\x8e%\'\xdc~3=mr%\xb3;X\xcf\xf4\x01\xd6\x86\x1b\xceY`\xdd\x91\x06S_\xc5+D\t\xbc\xebp\x08\x91&9\xa4\xeba\xcf\x11\x13F9L\xd3\xe1\xbcWP\xcb\xd9\x1c\xe3\xf1\xfdX\xcd%)\xbfMb[\xca\xd6 y\'%\x8c\xb7k\xc2\xe5\xbd\x9d\x03\xc2w;inD\xa95\xdf\xb0\xd84BE\xf9\xe0A\xb2\xed(zr\x9af\xe5\xbekx\xf1\xc9/\xba\x89\x8b\xc3\x86\x8e\xe6\nk{\xe6\x11\xc7\x98\x1db\xf4\x90I\xc1p\xc7Z\xb3\xe64\xc3=^+\xc4\x8c\xd9\xd5\x0e\xc2MH\xc1\xa7\x1aK,\x92\xcc\x94\x08\xf0e\xbd\xfbO\x15\xa5\xdac*K@p\xba\xf5\xcc\xd7R\xb3@F4\xfeH\xa4L\xea\xc2}\x8baY4\xc0\xca\x99\xcfE@\xd0m P\xe8J{TB\xb7\xe7\xac\xed\xb0\x81\xaaU\xb2\x1e\xb7F\x98{\xc4\x9b\xa3}\x16\x03\x03\x00\x04\x0e\x00\x00\x00q\x12u}q\x13(h\nK\x01h\x0bh\x0cC\x85\x16\x03\x03\x00%\x10\x00\x00! \xc8o\x9f\x989w7\x04[\xe8\xa0LJ\x17\xcd\xd0\x01u\xe8\xe0k\xb7\xb4\xa7\x9d!\xa7\x8a\xedN\xfb\x1b\x14\x03\x03\x00\x01\x01\x16\x03\x03\x00P&S3\x18E\xbb\x0f\xfe\xeb\xec\x16n0\x06$\xa7\xafS\x1d\xd7\x81\x90k\x87d\x91\x96\nA8\x85\xa0\xca\xea\xf8F\n&\x91\xcfm\xdc&\xe1\xb5\xe6\xb1\xbf\xd6\xab\x87\x0b?\xde\x92\x1f\xe8?\x94\x06\xcdm2\xa9^\n\xb8`R\x12\xca\xff\xce!\xbcFz\xb9\x1fFq\x14\x85q\x15Rq\x16}q\x17bu}q\x18(h\nK\x00h\x0bC[\x14\x03\x03\x00\x01\x01\x16\x03\x03\x00P-}\x89\xd2"\xb4P!\xd2}\xa3\x815\x14\x87\xd1\x92\xf6\xf3\xb8\xb3^m"\xa66\xed\xa6\xe7\xeaL\x17\xf43g}\x050\x08\xa1r\xe6\xec\xcf:^L\xcd\x92\xdfA\x18a\xcb\xa6\x98\x7f\xba\x9e\'\xf7+\x8a:M\xb5\x17\xf5\x974\xf4\xa6\x8aIH1\xae"\xac\x00q\x19u}q\x1a(h\nK\x01h\x0bh\x0cCU\x17\x03\x03\x00P8`?<\x80\xa7\xe9@\xf8\x11\x07W\xcc\x1f\x93<$%\xf6\xa5?Q|\xd1\x8cr\x15i\xdb\n\xef\x82\xb0\xf3\xb7p\x9b\xa0\xb1\x10\x00C\xff\xa02<\xd2QT\xa8\x88#\xcd\xd4\x94?\xfd\xf6(\xfar\x84\xf3\xe2\xb6\x92\xd9\xb4\xd9\x01F^3\x0c\\H\x11\xb1\x93\x8eq\x1b\x85q\x1cRq\x1d}q\x1ebueX\r\x00\x00\x00client_randomq\x1fh\x0cC _e\x12\xc5\x92\xbf2\xda\x01\xbf\x94 \xbf\x84\xba\xddR\x84,7CT\xb5\xc60\xd1\xaa\xe3\x9f\xc0Wqq \x85q!Rq"}q#bX\r\x00\x00\x00server_randomq$NX\x11\x00\x00\x00pre_master_secretq%NX\r\x00\x00\x00master_secretq&C0\xddD\x15\xc8\xf4\xb9\xfe\x02\xb7\xb5&\x81\x14\xf0\x99\xa7\xeeN\x80\xa8\x94\x8b$w\xfd\x9d\xa4\xe1\xa8\xa7\x06\xfc\\Q\x1cG\x1f\xe1\xf6T\x9d%\x88\xfb\x8eI\x1c\x13q\'X\x0b\x00\x00\x00private_keyq(C p$\xda)|\xb0J:\x92M\xb3\x92YWtL{\xac\x86\xa0S\xb2\x16\xf1 yL\x13\xbcmybq)ub.')
            
            recorder =  pickle.loads(b'\x80\x03ctlsclient.recorder\nRecorder\nq\x00)\x81q\x01}q\x02(X\x05\x00\x00\x00stateq\x03ctlsclient.recorder\nRecorderState\nq\x04K\x01\x85q\x05Rq\x06X\t\x00\x00\x00_msg_flowq\x07]q\x08(}q\t(X\t\x00\x00\x00directionq\nK\x01X\x03\x00\x00\x00msgq\x0bctlsclient.protocol\nProtocolData\nq\x0cC\x84\x16\x03\x01\x00\x7f\x01\x00\x00{\x03\x03_e)\x1e\xbfHh\x1a6\x0f\xd2m\x9e\xa6\x03g\xdc4\xe2n\xe0L\x0f\xdag\xe2\xcf\t?\xe9\xda\x84\x00\x00\x12\xc0\n\xc0#\xc0\t\xc0\x13\xc0\x14\x00/\x005\x00\n\xc0\'\x01\x00\x00@\x00\x00\x00\x0e\x00\x0c\x00\x00\tlocalhost\x00\n\x00\x0e\x00\x0c\x00\x1d\x00\x17\x00\x18\x00\x19\x01\x00\x01\x02\x00\r\x00\x18\x00\x16\x04\x03\x05\x03\x06\x03\x08\x04\x08\x05\x08\x06\x04\x01\x05\x01\x06\x01\x02\x03\x02\x01q\r\x85q\x0eRq\x0f}q\x10bu}q\x11(h\nK\x00h\x0bB\x8f\x05\x00\x00\x16\x03\x03\x00J\x02\x00\x00F\x03\x03P*\xea\xb9&\xb2\xd8\x7f1\x1e>\xed\x16\xac\x80\xda\x1a\x99\xb0D\xafT\x0e\x96\x89\x0c\xd7\xa0\\UY\xac \x05\xfb\x94\xa5\xe4\xc2\xaf\x14\xe5\xfaz@\x13\xbc\xfb\xe7)k\xee\xba\xb4\xf8\xf4\x1d\xdawV6\xe2<\xfam\xc0\'\x00\x16\x03\x03\x04\x01\x0b\x00\x03\xfd\x00\x03\xfa\x00\x03\xf70\x82\x03\xf30\x82\x02\xdb\xa0\x03\x02\x01\x02\x02\x14fC\x9d\x04>U\x0f\x7f\xde\xac_\xef\x8bj\x84\x1cX:\xca\x120\r\x06\t*\x86H\x86\xf7\r\x01\x01\x0b\x05\x000\x81\x881\x0b0\t\x06\x03U\x04\x06\x13\x02DE1\x100\x0e\x06\x03U\x04\x08\x0c\x07Germany1\r0\x0b\x06\x03U\x04\x07\x0c\x04Tamm1\x130\x11\x06\x03U\x04\n\x0c\nguballa.de1\x0f0\r\x06\x03U\x04\x0b\x0c\x06Privat1\x120\x10\x06\x03U\x04\x03\x0c\tlocalhost1\x1e0\x1c\x06\t*\x86H\x86\xf7\r\x01\t\x01\x16\x0fjens@guballa.de0\x1e\x17\r200905133359Z\x17\r210905133359Z0\x81\x881\x0b0\t\x06\x03U\x04\x06\x13\x02DE1\x100\x0e\x06\x03U\x04\x08\x0c\x07Germany1\r0\x0b\x06\x03U\x04\x07\x0c\x04Tamm1\x130\x11\x06\x03U\x04\n\x0c\nguballa.de1\x0f0\r\x06\x03U\x04\x0b\x0c\x06Privat1\x120\x10\x06\x03U\x04\x03\x0c\tlocalhost1\x1e0\x1c\x06\t*\x86H\x86\xf7\r\x01\t\x01\x16\x0fjens@guballa.de0\x82\x01"0\r\x06\t*\x86H\x86\xf7\r\x01\x01\x01\x05\x00\x03\x82\x01\x0f\x000\x82\x01\n\x02\x82\x01\x01\x00\xb2\xc8oZ\xe5\x1b\xbeM\xc4\x82,f\xbfU\xfa<R~\x93\xc7\xc6\xcb\xa6\xcf{&_\xb4\xb0S\x80\xb3x\xea6r}\x80\x8b\xad\xc5\xbe\x98\x1a\xd6\xd6\xdc\xa00\x91\x0c\xe2h\x80D\x94\\\x01<\xaa\xebmg\\cZ\x1b:H\xea\xec9\xc3Y\x9c\xca`\x196i\xbb\xbe\x1f\xae\xc3\xb9x\xc9\x82\xa1\xba\x17\x08\x17\xb6\xe1\x16\xae\xabq\xe9\xbaj\x84\xcd\xc4\xc7A\xb3.\t\xd7\xe1\xa8\x1b\xe3\x7fO\x03\xac\xddKy\x81*\xce\xa8r5\xc5L\xf5\x06x\x18GF#H5\xff\x0b\xf2\\`\xe3\x1a\xde\n\t\x02\xcf\\\x0b\xe3%\x14!o\xd2\x92*\x11\x8eO\xaaY\xb4bu\x8e`u\xc8\xa1%*\x93\x83\xf7C\xcf\xc6\xb8\xb33\xa5<\xf7\x9aQ-\xb9\xdf\xdc\x14\x17\x15G?\x8dC\x13\xfc\x8132\x92*\x08=\xae"\x06\xfe\x01\xea\t\xbb\x93,\x04"\xa3\xe3\xc4\nu\xe9\x17\xb1\x98j\x9e\x02\xf06\xaf\x07^\x00&\x10\xc6>\x95\xbe\xfb-/|\xdd\xd2\xb4~G\x02\x03\x01\x00\x01\xa3S0Q0\x1d\x06\x03U\x1d\x0e\x04\x16\x04\x14 \xfe,\xe5U9\xf7\x86(\'\x80%eg\x16=|\xa5`\x8a0\x1f\x06\x03U\x1d#\x04\x180\x16\x80\x14 \xfe,\xe5U9\xf7\x86(\'\x80%eg\x16=|\xa5`\x8a0\x0f\x06\x03U\x1d\x13\x01\x01\xff\x04\x050\x03\x01\x01\xff0\r\x06\t*\x86H\x86\xf7\r\x01\x01\x0b\x05\x00\x03\x82\x01\x01\x00\x96}\xb2\xfdY\xb4t\x1b#\x00 \x0eJ\xf7*\xe0q|\xe1\xd2\x04Aj-\xf0G\x91\xb0\xf3G\xb0\xedB\xc9\xbe\xeb c\xed\x99[\x10\x1e\xad\xafw\x03@S\x93\xd7\xed\xa1\x91*\xa6\xa6\x0e\xd6\x02\xc4\xf6G\xf8{\r\xbeT\x91\x91\xf9@\xeb\xa9H\x1f\xb7l$K\x05\\\xd5\x16h\xdem\x92\n^zkf\xa1\xed\xcc\x9a6D\xcf9\xd1\xbf\xc5C\xc1h\\\xe4\xe1\x1f\xf04Nm\xc2g\x0e\x90\x9b\xb4\x11\xa7Sr\xdc\xbe \xaf\x92\x05\xf9\xc6\xe7{\xad\x80\xe3\xa2\xb0\xa1vR\xc3\x91\xb2|<\xd3\x12Z\xa3\xa8`#K\x86?\xb3`\xa2-\x93\xfdR\x13\x00\xed\xb1B\x0c\xe7\x1de\x103K=0T\xa4\x98V\xe4\xd2\x0f>o:\xcaN\xcd\xfc\x11bU\xa1F%\x17\xa2) \xd2\x8cq\x80\xc1\xa4\x9c\x9e\xf0\x9fz\x1b\xa2\xd85\xb3\xf3\xa2\xf1\xd5\xe7{\x00\x15\x90A\x17\xaa\tP\x91u\x0eB\\u\xee\xcb\x86;7s0\xb0\x1e\x98\xfa"\x9c\xfe\xc9Oe\x16\x03\x03\x01,\x0c\x00\x01(\x03\x00\x1d \xa5\x86d\x7f\xd6\xf5\n\xe7r\xe0\x13\x97\xea\xf4\x08x\xc7\x9b-!\x1b\xd6\xca\xe9\x17\xc0\x04C0\xa8\xa5/\x08\x04\x01\x00\xaf\x8b/\x80\xdd%\xcf\xcc\xbd4\xc0C\xba#\xab\x1f\xe0\x11\x0c=\xbcE\x1e%\xf2\x0e\x0c-\xad)\x00\x8el\x88\x96\x16\xed\xb0/&\xad\xd5\xbb\xd9E_T\x14]\xa1\xb1\xb0JQ}\x89\xc6\xa5\x00\xa0\xfc\xdd\xecZ\xb7\xd6\'\xea\xa1\x981\xd0\xc3\x1f\x97Vo(k\xea\x978\xd2\xec\xbe\xda\xab\xca\x05}\x86\xdd0C\xe3?x\xbeW\xe1\x9c\xe1\xc6\xdee[\xfa88\xb4\xad\xa2lY\xec\xaf\x93\x1aR\x99\xea\x18#\xe7;\xca$]\xf3"\xe6V\xfb8\x8f\xdd\x84\x99\xb9\xf3\x9a\xf6H\xe7\xcb\xc3aJ\x8c\x92o\xd18(\xcd\xd1\xa7o\xea\xd6\x8f?GS\'\x1e\x9e\x12\xd7\xd7A\xc8\xc9\x0ciV\x0e\n\x18\xacVX\x8b6\xcd\xed5$\xfc\x9a\xd7\xb1\xad\x85N\x1a\xe4\x9eD\x8e\x99~\xd6_\x1a\xe1\x19 \xc7\xf52^\xda\xb9X\x00U\xa6\xd5\x10w\x14\x8c\xa5\x89\xcd\x97\x90=\xf0\xba 7\xc7w\x0c\xb2|\x8a\xbc\xfb\xf3\xb8J]`\xebG\x88i\xad\xe9\xe9\x13p\xd0\x16\x03\x03\x00\x04\x0e\x00\x00\x00q\x12u}q\x13(h\nK\x01h\x0bh\x0cC\x85\x16\x03\x03\x00%\x10\x00\x00! \x9emq8\x0c/\xa4<yH\x91\xa1\x1a\xa7[\xa8vt\xa2X\xf3\xf2kb\xadP\xf4\x90v\xa3h7\x14\x03\x03\x00\x01\x01\x16\x03\x03\x00P\xa7\xdb>\x17\x1e=9\xa8\xbe\xb7/\xe3\x00\x00\x00\x00I\x11\xd3\xcf\x8ao\x96\x0f\x01\xc8\xba\xedi\x85\x9c\xf5\x9f\x06>G\xa1\xd2(\xae\xb4/0\xcf\x9a\xe6L\x8b\xc80i\x9f)\xfa(\xe5O\xdfB\x8e\xcf\xdak\x91\xa9\x03}<\xd0\x84\xeb\xad\x03k\xf0]\x9c\xfd\xccRq\x14\x85q\x15Rq\x16}q\x17bu}q\x18(h\nK\x00h\x0bC[\x14\x03\x03\x00\x01\x01\x16\x03\x03\x00Pi\xe8\x96\nD\x0f^%\x8e\x8b\xb3\xe4\xf4\x8c\xe5U\xef"\xa7}\xb5\xa3\xf3\x99\x89\xf2_\xd1\x12\x02s|\x84R\xe8\x15\x9b\x07[\xbc-\xad\xf5\x9f\x0f\xd5\x81RF\xa9\xda.\x0evX_%,x\x0bL"\x87\x96ZU\xd4\xf2\xc9\x05\xfb=\x9cY\xba\xdf\x8evpbq\x19u}q\x1a(h\nK\x01h\x0bh\x0cCU\x17\x03\x03\x00P\xa7\xdb>\x17\x1e=9\xa8\xbe\xb7/\xe3\x00\x00\x00\x01\xb1\xc5\x00\t\xa5u\xcf<\xa6`\xf0\xbf=!\xe5\xa1I\xea\x00M\t\x1aq\xb9\x12vw\xa90\x9b\xd9wx\x93\x95Ag\x80W\x84\xfdn\x97\xff\r\xe1\xa4\xa2q|\xd4x+D\xb1\xcf>v\xebjB\xc6\x93\xb5q\x1b\x85q\x1cRq\x1d}q\x1ebueX\r\x00\x00\x00client_randomq\x1fh\x0cC _e)\x1e\xbfHh\x1a6\x0f\xd2m\x9e\xa6\x03g\xdc4\xe2n\xe0L\x0f\xdag\xe2\xcf\t?\xe9\xda\x84q \x85q!Rq"}q#bX\r\x00\x00\x00server_randomq$NX\x11\x00\x00\x00pre_master_secretq%NX\r\x00\x00\x00master_secretq&C0pt"\x1d;Tq\xd6\xdf\xcd\xa6\x98\xd7\xc8\xee\xd5\x93t\xad\xa7VaKG\xf2\x0fL\x0c\x88.\x9f=Fd$\xc8\xaa\xca$\xdb\xc8\x9fu\t{w_iq\'X\x0b\x00\x00\x00private_keyq(C \xe8EO\xce\xd1\xeeJ\x10l\x0e"\xbc\x0e\xa3I\x00C\x99\x11\xeeKyE\xac\xea\x80]dJ\xde\xa3Vq)X\x14\x00\x00\x00client_write_mac_keyq*h\x0cC \xf5\xd4^3\xe3\xd7\x7f\x1f\xad\xb0Qb\x1f\xf2\xa2\xb6\xc0\xc6\\|T0n\xac\x98\xfd\x107]\xd0\xad\xd0q+\x85q,Rq-}q.bX\x14\x00\x00\x00server_write_mac_keyq/h\x0cC }\xa8\xe3\xe1\xa4x\xe1=\x13U\xa7zu\xc9\x9b4\xd3\x12\xd7\xa4\xb4\x02\xa5\xed~\xcc\xdc\xf5^\xd2M\xaeq0\x85q1Rq2}q3bX\x10\x00\x00\x00client_write_keyq4h\x0cC\x10\xe0\xaa@\xd3\xde:!\xcd\x16\xd1-r}G/\x98q5\x85q6Rq7}q8bX\x10\x00\x00\x00server_write_keyq9h\x0cC\x10\xa1\xab\xa0g\x13\xf9\xf1>\t\xdc1\xeap|\xf7Yq:\x85q;Rq<}q=bX\x0f\x00\x00\x00client_write_ivq>h\x0cC\x10\xa7\xdb>\x17\x1e=9\xa8\xbe\xb7/\xe3\x949\xd8\xb5q?\x85q@RqA}qBbX\x0f\x00\x00\x00server_write_ivqCh\x0cC\x10\xdb\x0e^\x04\xd6\x05i\xee\xae\xf22\xee\x89\n,1qD\x85qERqF}qGbX\x18\x00\x00\x00verify_data_finished_recqHcbuiltins\nbytearray\nqIC\x0c\x93]\xb4\x017T\x9aC\x88\x00\xf6\x92qJ\x85qKRqLX\x19\x00\x00\x00verify_data_finished_calcqMC\x0c\x93]\xb4\x017T\x9aC\x88\x00\xf6\x92qNX\x17\x00\x00\x00msg_digest_finished_recqOC \xe8~x\x1d\x07\x90\x9bP\xd8\x82\xd1O\xb1f~q\x99\x11x\xa8\x87\xb3S\xcc\xcf\xbe\x08\xac\xe4\xab7\x16qPX\x18\x00\x00\x00msg_digest_finished_sentqQC \xb3\xef\x84r*[\xae\xed-\x10\xdd\xc9R\xaa\x01C\xf1>\xd7\x1b\x85(K\x88\xd0\xc8\xae\xff\x93\xc4\xd8\x7fqRX\x19\x00\x00\x00verify_data_finished_sentqSC\x0c7%\xe8\xd8\x0c\x88\\\x8e3\xea\x95\x1cqTub.')
            conn.set_recorder(recorder)
            conn.recorder.replay()

            #conn.recorder.record()

            # conn.open_socket()
            conn.send(msg.ClientHello)
            conn.wait(msg.ServerHello)
            conn.wait(msg.Certificate, optional=True)
            conn.wait(msg.ServerKeyExchange, optional=True)
            conn.wait(msg.ServerHelloDone)
            conn.send(msg.ClientKeyExchange, msg.ChangeCipherSpec, msg.Finished)
            conn.wait(msg.ChangeCipherSpec)
            conn.wait(msg.Finished)
            conn.send(msg.AppData(b"Hier kommen Daten!"))

            #print(pickle.dumps(conn.recorder))


            # conn.send(msg.ClientKeyExchange)
            # conn.send(msg.ChangeCipherSpec)
